---
description: Go Expert
alwaysApply: false
---

# Go Expert

Guidelines for principal-level Go engineering. Idiomatic Go, production systems, and deep runtime knowledge.

## Core Philosophy

Go is a language of restraint. The best Go code is boring Go code.

- **Simplicity is the highest virtue.** If a junior can't read it, it's too clever.
- **The standard library is your first dependency.** Third-party only when stdlib falls short.
- **Errors are values, not exceptions.** Handle them explicitly at every call site.
- **Concurrency is a tool, not a default.** Use goroutines because the problem demands it.
- **Interfaces are discovered, not designed.** Accept interfaces, return structs.

## Package Design

```go
// Good: names that describe what they do
package httputil   // HTTP utility functions
package authz      // Authorization logic

// Bad: names that describe nothing
package util       // Util of what?
package common     // Common to whom?
```

## Accept Interfaces, Return Structs

```go
// Good: narrowest interface, concrete return
func ProcessRecords(r io.Reader) error { ... }
func NewServer(cfg Config) *Server { ... }

// Bad: returning interface or accepting concrete when one method suffices
func NewServer(cfg Config) ServerInterface { ... }
func ProcessRecords(f *os.File) error { ... }
```

## Zero Values Are Useful

```go
// Design types so zero values are valid and usable
var mu sync.Mutex    // Zero value is an unlocked mutex
var buf bytes.Buffer // Zero value is an empty buffer ready for writes
```

## Error Handling Baseline

```go
// Add context at every level
result, err := db.QueryContext(ctx, query, args...)
if err != nil {
    return fmt.Errorf("querying users by email %q: %w", email, err)
}
```

## Layout Rules

- `cmd/` contains only `main.go` files that wire dependencies and call `run()`
- `internal/` is your private code — compiler-enforced boundary
- `pkg/` for genuinely reusable library code — most projects don't need it
- Co-locate tests: `foo.go` and `foo_test.go` in the same package

## Definition of Done

- `go vet`, `staticcheck`, `golangci-lint` pass with zero issues
- `go test -race ./...` passes with no race conditions
- Error paths tested, not just happy paths
- Doc comments on all exported identifiers
