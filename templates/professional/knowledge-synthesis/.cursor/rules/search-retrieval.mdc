---
description: Search and Retrieval
alwaysApply: false
---

# Search and Retrieval

Rules for finding, ranking, and presenting knowledge from the base.

## Search Methods

| Query Type | Primary Method | Fallback |
|------------|---------------|----------|
| Known item ("Find Smith 2024") | Lexical (title + author) | Metadata lookup |
| Topical ("Everything on X") | Hybrid (semantic + tag) | Lexical with synonyms |
| Relational ("What contradicts X?") | Graph traversal | Semantic + edge filter |
| Temporal ("Read last quarter") | Lexical + date range | Metadata filter |
| Exploratory ("Surprise me") | Semantic + random walk | Graph neighborhood |
| Synthesis ("Arguments for/against Y") | Graph + semantic | Multi-query expansion |

## Search Stack

1. **Lexical (BM25)** — Exact keywords, boolean ops, field-specific. Fast, precise.
2. **Semantic (Vector)** — Embedding similarity. Handles synonyms and paraphrases.
3. **Graph Traversal** — Follow edges to find related nodes. Best for relationships.
4. **Hybrid (Reciprocal Rank Fusion)** — Combine lexical + semantic, re-rank with cross-encoder.

Default to hybrid for general queries. Use specific methods when query type is unambiguous.

## Embedding Strategy

| Content Type | Granularity |
|-------------|-------------|
| Academic papers | Per paragraph (domain-specific model if available) |
| Book chapters | Per section (chunk at headings) |
| Personal notes | Per note (atomic) |
| Highlights | Per highlight (with context window) |

Re-embed on substantial updates, not minor edits.

## Retrieval Quality Targets

Precision@10 > 0.7, Recall@50 > 0.8, Mean Reciprocal Rank > 0.6, time to useful result < 30s.

## Result Presentation

- Show most relevant snippet, not entire note
- Highlight matching terms/passage
- Include metadata: source, date, tags, link count
- Group related results covering the same concept
- Surface contradictions explicitly

## Query Expansion

When results are poor: expand with synonyms from graph, broaden date range, relax tag filters, try semantic if lexical failed, suggest related queries.

## Indexing Rules

- Full-text index: synchronous on ingestion
- Vector index: async, within 5 minutes
- Graph index: on every node/edge creation
- Rebuild all indexes monthly; never serve stale results during rebuild
